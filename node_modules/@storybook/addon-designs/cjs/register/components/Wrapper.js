"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.Wrapper = void 0;
var react_1 = require("react");
var theming_1 = require("@storybook/theming");
var components_1 = require("@storybook/components");
var Figma_1 = require("./Figma");
var IFrame_1 = require("./IFrame");
var Image_1 = require("./Image");
var LinkPanel_1 = require("./LinkPanel");
var Sketch_1 = require("./Sketch");
var Tabs_1 = require("./Tabs");
var Figspec = (0, react_1.lazy)(function () { return Promise.resolve().then(function () { return require("./Figspec"); }); });
var Wrapper = function (_a) {
    var config = _a.config;
    if (!config || ("length" in config && config.length === 0)) {
        return ((0, theming_1.jsx)(components_1.Placeholder, null,
            (0, theming_1.jsx)(react_1.Fragment, null, "No designs found"),
            (0, theming_1.jsx)(react_1.Fragment, null,
                "Learn how to",
                " ",
                (0, theming_1.jsx)(components_1.Link, { href: "https://github.com/storybookjs/addon-designs#3-add-it-to-story", target: "_blank", rel: "noopener", withArrow: true, cancel: false }, "display design preview for the story"))));
    }
    var tabs = __spreadArray([], (config instanceof Array ? config : [config]), true).map(function (cfg) {
        var _a, _b;
        var meta = {
            id: JSON.stringify(cfg),
            name: cfg.name ||
                ((_a = cfg.type) === null || _a === void 0 ? void 0 : _a.toUpperCase()) ||
                "ERROR",
            offscreen: (_b = cfg.offscreen) !== null && _b !== void 0 ? _b : true,
        };
        switch (cfg.type) {
            case "iframe":
                return __assign(__assign({}, meta), { content: (0, theming_1.jsx)(IFrame_1.IFrame, { config: cfg }) });
            case "figma":
                return __assign(__assign({}, meta), { content: (0, theming_1.jsx)(Figma_1.Figma, { config: cfg }), offscreen: false });
            case "sketch":
                return __assign(__assign({}, meta), { content: (0, theming_1.jsx)(Sketch_1.Sketch, { config: cfg }) });
            case "figspec":
            case "experimental-figspec":
                if (cfg.type === "experimental-figspec") {
                    console.warn("[storybook-addon-designs] `experimental-figspec` is deprecated. We will remove it in v7.0. Please replace it to `figspec` type.");
                }
                return __assign(__assign({}, meta), { content: ((0, theming_1.jsx)(react_1.Suspense, { fallback: "Preparing Figspec viewer..." },
                        (0, theming_1.jsx)(Figspec, { config: cfg }))), offscreen: false });
            case "image":
                return __assign(__assign({}, meta), { content: (0, theming_1.jsx)(Image_1.ImagePreview, { config: cfg }) });
            case "link":
                return __assign(__assign({}, meta), { content: (0, theming_1.jsx)(LinkPanel_1.LinkPanel, { config: cfg }) });
        }
        return __assign(__assign({}, meta), { content: ((0, theming_1.jsx)(components_1.Placeholder, null,
                (0, theming_1.jsx)(react_1.Fragment, null, "Invalid config type"),
                (0, theming_1.jsx)(react_1.Fragment, null,
                    "Config type you set is not supported. Please choose one from",
                    " ",
                    (0, theming_1.jsx)(components_1.Link, { href: "https://github.com/storybookjs/addon-designs/blob/master/packages/storybook-addon-designs/src/config.ts", target: "_blank", rel: "noopener", withArrow: true, cancel: false }, "available config types")))) });
    });
    if (tabs.length === 1) {
        return (0, theming_1.jsx)("div", null, tabs[0].content);
    }
    return (0, theming_1.jsx)(Tabs_1.Tabs, { tabs: tabs, deps: [config] });
};
exports.Wrapper = Wrapper;
exports.default = exports.Wrapper;
